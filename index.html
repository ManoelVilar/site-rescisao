<!DOCTYPE html>
<html lang="pt-BR">
<head> 
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simulador de Rescis√£o</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: url('FUNDOTRABALHO.jpg') no-repeat center center fixed;
      background-size: cover;
    }
    .container {
      max-width: 500px;
      margin: auto;
      margin-top: 30px;
      background-color: #ffffffdd;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
    }
    h2 { text-align: center; color: #333; }
    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #007bff;
      color: white;
      font-weight: bold;
      border: none;
      margin-top: 20px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    #resultado { margin-top: 20px; }
    @media (max-width: 600px) {
      .container { margin: 10px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Simulador de Rescis√£o de Contrato</h2>

    <label>Nome do trabalhador:</label>
    <input type="text" id="nome" />

    <label>Sal√°rio bruto (R$):</label>
    <input type="number" id="salario" />

    <label>Data de admiss√£o:</label>
    <input type="date" id="admissao" />

    <label>Data de desligamento:</label>
    <input type="date" id="desligamento" />

    <label>J√° tirou f√©rias?</label>
    <select id="tirouFerias">
      <option value="nao">N√£o</option>
      <option value="sim">Sim</option>
    </select>

    <label>N√∫mero de filhos:</label>
    <input type="number" id="filhos" />

    <label>Motivo da dispensa:</label>
    <select id="motivo">
      <option value="sem_justa_causa">Sem justa causa</option>
      <option value="com_justa_causa">Com justa causa</option>
      <option value="pedido_demissao">Pedido de demiss√£o</option>
      <option value="acordo">Acordo entre as partes</option>
    </select>

    <label>Aviso pr√©vio indenizado?</label>
    <select id="aviso">
      <option value="sim">Sim</option>
      <option value="nao">N√£o</option>
    </select>

    <button onclick="calcular()">Calcular Rescis√£o</button>
    <button onclick="compartilharWhatsApp()">Compartilhar no WhatsApp</button>

    <div id="resultado"></div>
  </div>

  <script>
    function calcularMeses(admissao, desligamento) {
      let anos = desligamento.getFullYear() - admissao.getFullYear();
      let meses = desligamento.getMonth() - admissao.getMonth();
      let total = anos * 12 + meses;
      if (desligamento.getDate() < admissao.getDate()) total -= 1;
      return total < 0 ? 0 : total;
    }

    function calcularMesesProporcionais(inicio, fim) {
      let meses = 0;
      const data = new Date(inicio.getFullYear(), inicio.getMonth(), 1);
      while (data <= fim) {
        const ultimoDia = new Date(data.getFullYear(), data.getMonth() + 1, 0).getDate();
        const diasNoMes = (data.getMonth() === fim.getMonth() && data.getFullYear() === fim.getFullYear())
          ? fim.getDate()
          : ultimoDia;
        if (diasNoMes >= 15) meses++;
        data.setMonth(data.getMonth() + 1);
      }
      return meses;
    }

    function calcular() {
      const nome = document.getElementById('nome').value;
      const salario = parseFloat(document.getElementById('salario').value);
      const admissao = new Date(document.getElementById('admissao').value);
      const desligamento = new Date(document.getElementById('desligamento').value);
      const tirouFerias = document.getElementById('tirouFerias').value;
      const filhos = parseInt(document.getElementById('filhos').value) || 0;
      const motivo = document.getElementById('motivo').value;
      const aviso = document.getElementById('aviso').value;

      const mesesTrabalhados = calcularMeses(admissao, desligamento);

      const diasTrabalhados = desligamento.getDate();
      const saldoSalario = (salario / 30) * diasTrabalhados;

      const inicioAno = new Date(desligamento.getFullYear(), 0, 1);
      const inicio13 = admissao > inicioAno ? admissao : inicioAno;
      const meses13 = calcularMesesProporcionais(inicio13, desligamento);
      const decimo = motivo !== "com_justa_causa" ? (salario / 12) * meses13 : 0;

      let dataInicioFerias = admissao;
      if (tirouFerias === "sim") {
        dataInicioFerias = new Date(admissao.getFullYear() + 1, admissao.getMonth(), admissao.getDate());
      }
      const mesesFerias = motivo !== "com_justa_causa" ? calcularMesesProporcionais(dataInicioFerias, desligamento) : 0;
      const ferias = (salario / 12) * mesesFerias;
      const umTercoFerias = ferias / 3;

      const fgts = salario * 0.08 * mesesTrabalhados;
      let multaFgts = 0;
      if (motivo === "sem_justa_causa") multaFgts = fgts * 0.4;
      if (motivo === "acordo") multaFgts = fgts * 0.2;

      const avisoPrevio = aviso === "sim" && motivo !== "com_justa_causa" ? salario : 0;
      const bonusFilhos = filhos * 50;
      const inss = salario * 0.08;
      const ir = salario > 2112 ? salario * 0.075 : 0;

      const total = saldoSalario + ferias + umTercoFerias + decimo + avisoPrevio + multaFgts + bonusFilhos - inss - ir;

      // Salvar no hist√≥rico
      let historico = JSON.parse(localStorage.getItem('historicoRescisoes')) || [];
      historico.push({
        nome,
        data: new Date().toLocaleString('pt-BR'),
        total: total.toFixed(2)
      });
      localStorage.setItem('historicoRescisoes', JSON.stringify(historico));

      let htmlHistorico = "<h3>üìú Hist√≥rico de Simula√ß√µes</h3>";
      historico.slice(-5).reverse().forEach(item => {
        htmlHistorico += `<p><strong>${item.nome}</strong> - ${item.data} - R$ ${item.total}</p>`;
      });

      document.getElementById('resultado').innerHTML = `
        <hr>
        <p><strong>Trabalhador:</strong> ${nome}</p>
        <p>Tempo de trabalho: ${mesesTrabalhados} m√™s(es)</p>
        <p>Saldo de sal√°rio (${diasTrabalhados} dias): R$ ${saldoSalario.toFixed(2)}</p>
        <p>F√©rias proporcionais (${mesesFerias} meses): R$ ${ferias.toFixed(2)}</p>
        <p>1/3 de f√©rias: R$ ${umTercoFerias.toFixed(2)}</p>
        <p>13¬∫ proporcional (${meses13} meses): R$ ${decimo.toFixed(2)}</p>
        <p>Aviso pr√©vio: R$ ${avisoPrevio.toFixed(2)}</p>
        <p>FGTS acumulado (8%/m√™s): R$ ${fgts.toFixed(2)}</p>
        <p>Multa FGTS: R$ ${multaFgts.toFixed(2)}</p>
        <p>B√¥nus por filhos: R$ ${bonusFilhos.toFixed(2)}</p>
        <p>Desconto INSS: R$ ${inss.toFixed(2)}</p>
        <p>Desconto IR: R$ ${ir.toFixed(2)}</p>
        <hr>
        <p><strong>Total l√≠quido estimado: R$ ${total.toFixed(2)}</strong></p>
        ${htmlHistorico}
      `;
    }

    function compartilharWhatsApp() {
      const texto = document.getElementById('resultado').innerText;
      const url = `https://wa.me/?text=${encodeURIComponent(texto)}`;
      window.open(url, '_blank');
    }
  </script>
</body>
</html>
